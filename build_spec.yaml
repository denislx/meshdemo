version: 0.1             
component: build
timeoutInSeconds: 5000
shell: bash
env:
  exportedVariables:
    - version
steps:
  - type: Command
    command: |
      version=1.0
      echo "Version: ${version}"
  - type: Command
    command: |
      curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl"
      chmod +x kubectl
      kubectl version
  - type: Command
    command: |
      docker build -t ams.ocir.io/frsxwtjslf35/meshdemo-homesvc:latest .
      docker tag ams.ocir.io/frsxwtjslf35/meshdemo-homesvc:latest ams.ocir.io/frsxwtjslf35/meshdemo-homesvc:${version}
outputArtifacts:
  - name: meshdemo-homesvc-latest
    type: DOCKER_IMAGE
    location: ams.ocir.io/frsxwtjslf35/meshdemo-homesvc:latest
  - name: meshdemo-homesvc
    type: DOCKER_IMAGE
    location: ams.ocir.io/frsxwtjslf35/meshdemo-homesvc